(function(){"use strict";angular.module("tubular-widget.directives",["tubular.services"]).directive("tbWidgetContainer",[function(){return{template:'<div class="container"><ng-transclude><\/ng-transclude><\/div>',restrict:"E",replace:!0,transclude:!0,scope:!1,controller:["$scope",function(n){n.widgets=[];n.redraw=function(){angular.forEach(n.widgets,function(n){var t=n.content.parent();n.oneColumn?t.find("div.widget-panel").length===1&&t.next().hasClass("row")&&t.next().find("div.widget-panel").length===1&&(t.append(t.next().find("div.widget-panel")),t.next().remove()):t.find("div.widget-panel").length>1&&$('<div class="row"><\/div>').insertBefore(t).append(n.content)})}}]}}]).directive("tbWidget",[function(){return{template:'<div class="widget-panel"><div class="tubular-overlay maximize" ng-show="maximize"><\/div><div ng-class="{ \'col-md-6\': oneColumn, \'col-md-12\': !oneColumn, \'maximize\': maximize}"><div class="panel panel-default"><div class="panel-heading">{{title}}<div class="pull-right"><div class="dropdown"><button class="btn btn-xs btn-default dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true"><span class="caret"><\/span><\/button><ul class="dropdown-menu dropdown-menu-right"><li ng-hide="!oneColumn"><a href="#" ng-click="oneColumn = false">Two columns<\/a><\/li><li ng-hide="oneColumn"><a href="#" ng-click="oneColumn = true">One column<\/a><\/li><li ng-hide="maximize"><a href="#" ng-click="maximize = true">Maximize<\/a><\/li><li ng-hide="!maximize"><a href="#" ng-click="maximize = false">Restore<\/a><\/li><li ng-hide="top"><a href="#" ng-click="move(-2)">Move up<\/a><\/li><li ng-hide="bottom"><a href="#" ng-click="move(2)">Move down<\/a><\/li><li ng-hide="!oneColumn || !even"><a href="#" ng-click="move(1)">Move right<\/a><\/li><li ng-hide="!oneColumn || even"><a href="#" ng-click="move(-1)">Move left<\/a><\/li><\/ul><\/div><\/div><\/div><div class="panel-body"><ng-transclude><\/ng-transclude><\/div><\/div>',restrict:"E",replace:!0,transclude:!0,scope:{title:"@"},controller:function(n,t){function i(n,t){var i=n.parentNode,r=n.nextSibling===t?n:n.nextSibling;t.parentNode.insertBefore(n,t);i.insertBefore(t,r)}n.oneColumn=!0;n.maximize=!1;n.pos=0;n.content=t;n.container=n.$parent.$parent;n.container.widgets.push(n);n.calculatePositions=function(t){n.top=t===0||t===1;n.bottom=t===n.container.widgets.length-1||t===n.container.widgets.length-2;n.even=t%2==0;n.pos=t};n.$watch("$parent.widgets",function(){var t=n.container.widgets.indexOf(n);n.calculatePositions(t)});n.$watch("oneColumn",function(){n.container.redraw()});n.move=function(r){var u=n.container.widgets[n.pos+r];n.container.widgets[n.pos+r]=n;n.container.widgets[n.pos]=u;u.calculatePositions(n.pos);n.calculatePositions(n.pos+r);i(u.content[0],t[0]);n.container.redraw()}}}}])})();